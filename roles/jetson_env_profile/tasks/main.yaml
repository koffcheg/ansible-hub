---
- name: Ensure ~/.profile contains eco kiosk environment block
  become: true
  become_user: checkout
  blockinfile:
    path: /home/checkout/.profile
    create: yes
    marker: "# {mark} ECO_KIOSK_ENV"
    block: |
      # ECO Boutique kiosk environment
      if [ -z "$DISPLAY" ]; then
        export DISPLAY=":0"
      fi

      if [ -z "$XDG_RUNTIME_DIR" ]; then
        export XDG_RUNTIME_DIR="/run/user/$(id -u)"
      fi

      if [ -z "$DBUS_SESSION_BUS_ADDRESS" ]; then
        export DBUS_SESSION_BUS_ADDRESS="unix:path=$XDG_RUNTIME_DIR/bus"
      fi

      if [ -z "$PULSE_SERVER" ]; then
        export PULSE_SERVER="unix:$XDG_RUNTIME_DIR/pulse/native"
      fi
