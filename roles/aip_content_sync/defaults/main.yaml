---
# 1. GCP / Bucket configuration
bucket: "content-deployment-lab-01"
aip_cs_bucket: "{{ bucket }}"
aip_cs_gcp_project: "{{ aip_gcp_project | default('deployment-setup-lab-01') }}"
aip_cs_controller_tmp_root: "/tmp/aip_content"
aip_cs_work_dir: "{{ aip_cs_controller_tmp_root }}"
aip_cs_controller_host: "localhost"

# 2. Jetson deployments / state directories
aip_deploy_root: "/home/checkout/deployments"
aip_deploy_user: "checkout"

aip_state_root: "/opt/aip/state"
aip_state_stage_dir: "{{ aip_state_root }}/stage"
aip_state_backups_dir: "{{ aip_state_root }}/backups"
aip_state_receipts_dir: "{{ aip_state_root }}/receipts"

aip_state_dir: "{{ aip_state_root }}"
stage_root: "{{ aip_state_stage_dir }}"
backups_root: "{{ aip_state_backups_dir }}"
receipts_root: "{{ aip_state_receipts_dir }}"

deployments_root: "{{ aip_deploy_root }}"
current: "current"

allowed_roots:
  - "{{ deployments_root }}/current"
  - "{{ deployments_root }}"
  - "/opt/aip"
  - "/var/lib/aip"

# behaviour defaults â€“ SAFE values, overridden by manifest.rules or explicit vars
enable_simple_backup: false     # fallback if NO rules.enable_simple_backup
prune_extraneous: false         # fallback if NO rules.prune_extraneous
target_version: "current"
aip_compose_refresh_after_sync: false
aip_content_dry_run: false

healthcheck: {}

# 3. Content bundle identity / manifest location

# bundle_id MUST be provided via -e or inventory (used for receipts, stage dir, etc.).
bundle_id: ""        # REQUIRED via -e or inventory

# Optional explicit manifest URL (fully qualified).
# If set, this is used directly and NO auto-discovery is performed.
bundle_manifest_url: ""

# Optional base folder that contains manifest.yml and content.
# If set (and bundle_manifest_url is empty), we probe:
#   <bundle_root_url>/manifest.yml
bundle_root_url: ""

# Optional bundle type (legacy convention: config/features/media/etc.).
# Used only for fallback discovery if both bundle_manifest_url and
# bundle_root_url are empty.
bundle_type: ""      # optional, we prefer autodiscovery via URLs

# Bandwidth / rsync tuning for Jetson sync
# 0 = unlimited (rsync default). Set e.g. 200 for ~200 KB/s, etc.
aip_cs_rsync_bwlimit_kbps: 0

# Extra raw rsync options for sync from controller -> Jetson.
# Example: ["--progress"] for debugging.
aip_cs_rsync_extra_opts: []

# 4. Targeting / gating slugs (host identity)
# IMPORTANT: these default to "" so that if nothing is provided
# and manifest has targets, we simply SKIP instead of failing.
region_slug: ""
warehouse_slug: ""
store_slug: ""
device_slug: ""
